<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Accept Bid Address Display</title>
  <link rel="stylesheet" href="static/css/modals/accept_bid_modals.css">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #1a1a2e;
      color: #eee;
      padding: 40px;
    }
    .test-container {
      max-width: 1200px;
      margin: 0 auto;
      background: #16213e;
      border-radius: 12px;
      padding: 30px;
    }
    h1 {
      color: #10b981;
      margin-bottom: 10px;
    }
    .test-section {
      background: #0f3460;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }
    .test-section h2 {
      color: #60a5fa;
      margin-top: 0;
      font-size: 18px;
    }
    .test-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }
    .test-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 15px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.2s;
    }
    .test-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    .test-btn:active {
      transform: translateY(0);
    }
    .console-output {
      background: #000;
      border-radius: 8px;
      padding: 15px;
      margin-top: 20px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      max-height: 400px;
      overflow-y: auto;
    }
    .log-line {
      margin: 3px 0;
      padding: 2px 0;
    }
    .log-label {
      color: #60a5fa;
      font-weight: bold;
    }
    .log-value {
      color: #10b981;
    }
    .log-separator {
      color: #666;
      margin: 8px 0;
    }
    .status {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 10px;
    }
    .status.success {
      background: #10b981;
      color: white;
    }
    .status.info {
      background: #3b82f6;
      color: white;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>ðŸ§ª Accept Bid Address Display Test</h1>
    <p>Testing the fix: Backend now returns <code>order_details</code> with <code>delivery_address</code></p>

    <div class="test-section">
      <h2>Test Scenarios <span class="status info">New Backend Response</span></h2>
      <p>These tests simulate the backend returning order details with delivery address</p>
      <div class="test-grid">
        <button class="test-btn" onclick="testFullAddress()">
          Test 1: Full Address<br>
          <small>(Street â€¢ Line2 â€¢ City, State ZIP)</small>
        </button>
        <button class="test-btn" onclick="testNoLine2()">
          Test 2: No Line 2<br>
          <small>(Street â€¢ City, State ZIP)</small>
        </button>
        <button class="test-btn" onclick="testWithComma()">
          Test 3: With Comma After State<br>
          <small>(City, State, ZIP)</small>
        </button>
        <button class="test-btn" onclick="testSimpleText()">
          Test 4: Simple Text<br>
          <small>(Legacy format)</small>
        </button>
        <button class="test-btn" onclick="testRealWorldExample()">
          Test 5: Real World Example<br>
          <small>(User reported format)</small>
        </button>
        <button class="test-btn" onclick="testEmptyAddress()">
          Test 6: Empty Address<br>
          <small>(Should show "â€”")</small>
        </button>
      </div>
    </div>

    <div class="test-section">
      <h2>Console Output</h2>
      <div class="console-output" id="consoleOutput"></div>
    </div>
  </div>

  <!-- Include the modals -->
  <div id="acceptBidSuccessModal" class="modal-overlay" style="display: none;">
    <div class="modal-dialog accept-bid-success-modal">
      <div class="modal-header success-header">
        <h2>ðŸŽ‰ Congratulations!</h2>
        <button type="button" class="modal-close" onclick="closeAcceptBidSuccessModal()" aria-label="Close">&times;</button>
      </div>

      <div class="modal-body">
        <div class="success-content">
          <p class="success-message">You have successfully accepted the bid!</p>

          <div class="order-details">
            <h3>Order Details</h3>

            <div class="detail-section">
              <h4>Buyer Information</h4>
              <div class="detail-row">
                <span class="detail-label">Name:</span>
                <span class="detail-value" id="success-buyer-name">â€”</span>
              </div>
            </div>

            <div class="detail-section">
              <h4>Delivery Address</h4>
              <div class="detail-row" id="success-address-line1-row">
                <span class="detail-label">Address Line 1:</span>
                <span class="detail-value" id="success-address-line1">â€”</span>
              </div>
              <div class="detail-row" id="success-address-line2-row">
                <span class="detail-label">Address Line 2:</span>
                <span class="detail-value" id="success-address-line2">â€”</span>
              </div>
              <div class="detail-row" id="success-address-city-row">
                <span class="detail-label">City:</span>
                <span class="detail-value" id="success-address-city">â€”</span>
              </div>
              <div class="detail-row" id="success-address-state-row">
                <span class="detail-label">State:</span>
                <span class="detail-value" id="success-address-state">â€”</span>
              </div>
              <div class="detail-row" id="success-address-zip-row">
                <span class="detail-label">ZIP Code:</span>
                <span class="detail-value" id="success-address-zip">â€”</span>
              </div>
            </div>

            <div class="detail-section">
              <h4>Transaction Details</h4>
              <div class="detail-row">
                <span class="detail-label">Price per item:</span>
                <span class="detail-value price-highlight" id="success-price">â€”</span>
              </div>
              <div class="detail-row">
                <span class="detail-label">Quantity:</span>
                <span class="detail-value" id="success-quantity">â€”</span>
              </div>
              <div class="detail-row">
                <span class="detail-label">Total value:</span>
                <span class="detail-value total-highlight" id="success-total">â€”</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer success-footer">
        <hr class="footer-divider">
        <button type="button" class="btn btn-primary" onclick="closeAcceptBidSuccessModal()">Close</button>
      </div>
    </div>
  </div>

  <script src="static/js/modals/accept_bid_modals.js"></script>
  <script>
    const consoleOutput = document.getElementById('consoleOutput');

    // Override console.log to show in page
    const originalLog = console.log;
    console.log = function(...args) {
      originalLog.apply(console, args);

      const line = document.createElement('div');
      line.className = 'log-line';

      const text = args.map(arg => {
        if (typeof arg === 'object') {
          return JSON.stringify(arg, null, 2);
        }
        return String(arg);
      }).join(' ');

      if (text.includes('SUCCESS MODAL')) {
        const parts = text.split(':');
        if (parts.length >= 2) {
          line.innerHTML = `<span class="log-label">${parts[0]}:</span> <span class="log-value">${parts.slice(1).join(':')}</span>`;
        } else {
          line.textContent = text;
        }
      } else if (text.includes('===')) {
        line.innerHTML = `<div class="log-separator">${text}</div>`;
      } else {
        line.textContent = text;
      }

      consoleOutput.appendChild(line);
      consoleOutput.scrollTop = consoleOutput.scrollHeight;
    };

    function testFullAddress() {
      console.log('================================================================================');
      console.log('TEST 1: Full Address with Line 2');
      openAcceptBidSuccessModal({
        buyer_name: 'John Smith',
        delivery_address: 'John Smith â€¢ 123 Main Street â€¢ Apt 4B â€¢ New York, NY 10001',
        price_per_coin: 2150.50,
        quantity: 3,
        total_price: 6451.50
      });
    }

    function testNoLine2() {
      console.log('================================================================================');
      console.log('TEST 2: Address without Line 2');
      openAcceptBidSuccessModal({
        buyer_name: 'Jane Doe',
        delivery_address: 'Jane Doe â€¢ 456 Oak Avenue â€¢ Boston, MA 02101',
        price_per_coin: 1850.00,
        quantity: 5,
        total_price: 9250.00
      });
    }

    function testWithComma() {
      console.log('================================================================================');
      console.log('TEST 3: Address with Comma After State');
      openAcceptBidSuccessModal({
        buyer_name: 'Rex Apthorpe',
        delivery_address: 'Rex Apthorpe â€¢ 1 main street â€¢ Apt 6D â€¢ Brooklyn, NY, 11201',
        price_per_coin: 2250.75,
        quantity: 2,
        total_price: 4501.50
      });
    }

    function testSimpleText() {
      console.log('================================================================================');
      console.log('TEST 4: Simple Text Address (Legacy)');
      openAcceptBidSuccessModal({
        buyer_name: 'Test User',
        delivery_address: 'test address simple text',
        price_per_coin: 1950.00,
        quantity: 1,
        total_price: 1950.00
      });
    }

    function testRealWorldExample() {
      console.log('================================================================================');
      console.log('TEST 5: Real World Example (User Reported)');
      openAcceptBidSuccessModal({
        buyer_name: 'rexe',
        delivery_address: 'Rex Apthorpe â€¢ 1 main street â€¢ Apt 6D â€¢ Brooklyn, NY, 11201',
        price_per_coin: 2200.00,
        quantity: 4,
        total_price: 8800.00
      });
    }

    function testEmptyAddress() {
      console.log('================================================================================');
      console.log('TEST 6: Empty Address');
      openAcceptBidSuccessModal({
        buyer_name: 'Anonymous',
        delivery_address: '',
        price_per_coin: 2000.00,
        quantity: 1,
        total_price: 2000.00
      });
    }

    console.log('âœ… Test environment loaded');
    console.log('Click any test button to simulate accepting a bid with the new backend response');
    console.log('');
  </script>
</body>
</html>
