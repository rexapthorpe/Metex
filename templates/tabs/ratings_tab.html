<div class="ratings-tab">

  <div class="ratings-content">
    <div class="rating-average-container">
      <div class="rating-average-text" id="average-rating-text">
        {% if avg_rating %}
          {{ '%.1f'|format(avg_rating) }}
        {% else %}
          --
        {% endif %}
      </div>
      <div class="rating-count-text">
        Average rating from {{ received_ratings|length }}
        transaction{{ 's' if received_ratings|length != 1 else '' }}
      </div>
    </div>

    <hr class="rating-divider">

    {% if received_ratings %}
      <div class="rating-tiles-container">
        {% for r in received_ratings %}
          <div class="rating-tile">
            <!-- Header: rater image, name, stars, timestamp -->
            <div class="rating-header">
              <img
                src="{{ r['rater_image_url'] or url_for('static', filename='img/placeholder.png') }}"
                alt="{{ r['rater_name'] }}"
                class="profile-img"
              >
              <div class="rating-stars-date">
                <div class="stars">
                  {% for i in range(1,6) %}
                    {% if r['rating'] >= i %}
                      <i class="fa-solid fa-star filled"></i>
                    {% else %}
                      <i class="fa-regular fa-star"></i>
                    {% endif %}
                  {% endfor %}
                </div>
                <div class="rating-meta">
                  {{ r['timestamp'] }} | From: <strong>{{ r['rater_name'] }}</strong>
                </div>
              </div>
            </div>

            <!-- Comment section -->
            <div class="rating-comment">
              {{ r['comment'] or 'â€” No comment provided' }}
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="empty-message">You have not received any ratings yet.</p>
    {% endif %}
  </div>

  <script src="{{ url_for('static', filename='js/tabs/ratings_tab.js') }}"></script>
</div>
